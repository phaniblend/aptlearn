{
  "id": "nodejs-25-jwt-verification",
  "title": "JWT Verification",
  "technology": "Nodejs",
  "difficulty": "mid",
  "language": "javascript",
  "status": "draft",
  "metadata": {
    "time_estimate": "20 minutes",
    "tests": "JWT validation, protected routes",
    "challenge_number": "25"
  },
  "flow": [
    {
      "stepId": "title",
      "mentorSays": "At the end of this lesson, you will be able to:\n\n1. Understand JWT Verification in Nodejs\n2. Implement the solution using JWT validation, protected routes\n3. Apply Angular best practices and patterns\n4. Handle edge cases and error scenarios\n5. Write clean, maintainable Nodejs code",
      "action": "continue",
      "next": "problem-illustration"
    },
    {
      "stepId": "problem-illustration",
      "mentorSays": "Let's understand what this JWT Verification challenge asks for.\n\n**Challenge Description:**\n// Create middleware to verify JWT:\n// - Extract token from Authorization header\n// - Verify token\n// - Attach decoded data to req\n// - Protect routes with middleware\n\n**What we need to build:**\nThis challenge tests your understanding of JWT validation, protected routes.\n\n**Time estimate:** 20 minutes\n**Difficulty level:** Mid\n\n**Expected Solution Overview:**\n```typescript\nconst jwt = require('jsonwebtoken');\n\nconst verifyToken = (req, res, next) => {\n  const authHeader = req.headers.authorization;\n\n  if (!authHeader || !authHeader.startsWith('Bearer ')) {\n    return res.status(401).json({ error: 'No token provided' });\n  }\n\n  const token = authHeader.split(' ')[1];\n\n...\n```\n\nThis is a practical interview question that tests your understanding of core Angular concepts and your ability to implement them correctly.",
      "example": "// Create middleware to verify JWT:\n// - Extract token from Authorization header\n// - Verify token\n// - Attach decoded data to req\n// - Protect routes with middleware",
      "action": "continue",
      "next": "thinking-challenge"
    },
    {
      "stepId": "thinking-challenge",
      "mentorSays": "Now that you understand what the problem wants, here's the real question:\n\nHow would YOU solve this JWT Verification challenge?\n\nThink about it for a moment. What approach feels natural to you?",
      "choices": [
        {
          "label": "I'll start with the basic approach and build up",
          "next": "explore-approach-1"
        },
        {
          "label": "I want to see the optimal solution directly",
          "next": "explore-optimal"
        },
        {
          "label": "I need more context about the problem",
          "next": "problem-illustration"
        }
      ]
    },
    {
      "stepId": "explore-approach-1",
      "mentorSays": "Good! Starting with a basic approach is a solid strategy. Let's build it step by step, then we'll see the complete solution.",
      "action": "continue",
      "next": "explore-optimal"
    },
    {
      "stepId": "explore-optimal",
      "mentorSays": "Perfect! Here's the optimal solution approach:\n\n```typescript\nconst jwt = require('jsonwebtoken');\n\nconst verifyToken = (req, res, next) => {\n  const authHeader = req.headers.authorization;\n\n  if (!authHeader || !authHeader.startsWith('Bearer ')) {\n    return res.status(401).json({ error: 'No token provided' });\n  }\n\n  const token = authHeader.split(' ')[1];\n\n  try {\n    const decoded = jwt.verify(token, SECRET);\n    req.user = decoded;\n    next();\n  } catch (err) {\n    res.status(401).json({ error: 'Invalid token' });\n  }\n};\n\n// Protected route\napp.get('/profile', verifyToken, (req, res) => {\n  res.json({ user: req.user });\n});\n```\n\nThis solution demonstrates best practices for Nodejs development and shows how to properly implement JWT validation, protected routes.",
      "example": "const jwt = require('jsonwebtoken');\n\nconst verifyToken = (req, res, next) => {\n  const authHeader = req.headers.authorization;\n\n  if (!authHeader || !authHeader.startsWith('Bearer ')) {\n    return res.status(401).json({ error: 'No token provided' });\n  }\n\n  const token = authHeader.split(' ')[1];\n\n  try {\n    const decoded = jwt.verify(token, SECRET);\n    req.user = decoded;\n    next();\n  } catch (err) {\n    res.status(401).json({ error: 'Invalid token' });\n  }\n};\n\n// Protected route\napp.get('/profile', verifyToken, (req, res) => {\n  res.json({ user: req.user });\n});",
      "action": "continue",
      "next": "language-selection"
    },
    {
      "stepId": "language-selection",
      "mentorSays": "Great! Now let's code this solution. Which programming language would you like to use?",
      "choices": [
        {
          "label": "JavaScript",
          "next": "variable-check-js"
        },
        {
          "label": "TypeScript",
          "next": "variable-check-ts"
        },
        {
          "label": "Python",
          "next": "variable-check-python"
        }
      ]
    },
    {
      "stepId": "coding-start-ts",
      "mentorSays": "Let's implement the solution:",
      "example": "const jwt = require('jsonwebtoken');\n\nconst verifyToken = (req, res, next) => {\n  const authHeader = req.headers.authorization;\n\n  if (!authHeader || !authHeader.startsWith('Bearer ')) {\n    return res.status(401).json({ error: 'No token provided' });\n  }\n\n  const token = authHeader.split(' ')[1];\n\n  try {\n    const decoded = jwt.verify(token, SECRET);\n    req.user = decoded;\n    next();\n  } catch (err) {\n    res.status(401).json({ error: 'Invalid token' });\n  }\n};\n\n// Protected route\napp.get('/profile', verifyToken, (req, res) => {\n  res.json({ user: req.user });\n});",
      "action": "continue",
      "next": "test-code-ts"
    },
    {
      "stepId": "test-code-ts",
      "mentorSays": "Perfect! Now test your code. Make sure it works correctly for the JWT Verification challenge.\n\n**Test Cases:**\n1. Test with basic input\n2. Test with edge cases\n3. Test with empty/null values\n4. Verify the output matches expected behavior\n\nTry running it and verify the solution works as expected.",
      "example": "// Test cases for JWT Verification\n// 1. Basic functionality\n// 2. Edge cases\n// 3. Error handling",
      "action": "continue",
      "next": "final"
    },
    {
      "stepId": "final",
      "mentorSays": "ðŸŽ‰ Well done! You've completed the JWT Verification challenge.\n\n**Key Takeaways:**\n- You've mastered JWT validation, protected routes\n- You understand how to implement JWT Verification in Nodejs\n- You've applied best practices for Nodejs development\n- You can handle this type of interview question confidently\n\n**Time Complexity:** Varies based on implementation\n**Space Complexity:** Varies based on implementation\n\n**Related Challenges:**\n- Practice similar Nodejs concepts\n- Try variations of this challenge\n- Explore more advanced Nodejs patterns\n\nKeep practicing!",
      "action": "continue"
    }
  ]
}